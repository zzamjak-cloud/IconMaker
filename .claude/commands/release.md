# 버전 업데이트 및 릴리스 자동화

당신은 IconMaker 프로젝트의 버전 관리 및 릴리스 자동화를 담당하는 에이전트입니다.

## 작업 프로세스

### 1단계: 현재 상태 분석
다음 파일들을 읽어서 현재 버전과 최근 변경사항을 파악하세요:
- `package.json` - 현재 버전 확인
- `CHANGELOG.md` - 최근 변경사항 확인 (없으면 생성)
- `TECHNICAL_DOCUMENTATION.md` - 기술 문서 확인
- `git log --oneline -20` - 최근 커밋 이력 확인

### 2단계: 버전 결정
사용자의 요청과 변경 내용을 분석하여 적절한 버전을 결정하세요:

**시맨틱 버전닝 규칙:**
- **MAJOR (1.0.0 → 2.0.0)**: 호환성이 깨지는 변경
  - API 변경, 주요 아키텍처 변경
  - 예: "큰 업데이트", "메이저 버전", "breaking change"

- **MINOR (1.0.0 → 1.1.0)**: 하위 호환 가능한 기능 추가
  - 새로운 기능 추가, 기능 개선
  - 예: "새 기능 추가", "기능 개선", "feature"

- **PATCH (1.0.0 → 1.0.1)**: 버그 수정
  - 버그 수정, 작은 개선
  - 예: "버그 수정", "hotfix", "patch"

**분석 기준:**
1. 최근 커밋 메시지에서 키워드 추출
2. 사용자 요청 분석 ("적절한 단계" = 자동 판단)
3. CHANGELOG.md의 Unreleased 섹션 분석

### 3단계: CHANGELOG.md 업데이트
다음 형식으로 CHANGELOG.md를 업데이트하세요:

```markdown
# Changelog

All notable changes to this project will be documented in this file.

## [Unreleased]

## [새버전] - YYYY-MM-DD

### Added
- 새로 추가된 기능들

### Changed
- 변경된 기능들

### Fixed
- 수정된 버그들

## [이전버전] - YYYY-MM-DD
...
```

**작업 방법:**
1. CHANGELOG.md가 없으면 생성
2. Unreleased 섹션의 내용을 새 버전 섹션으로 이동
3. git log 분석하여 자동으로 변경사항 추출
4. 날짜는 오늘 날짜로 설정

### 4단계: TECHNICAL_DOCUMENTATION.md 업데이트
기술 문서에서 버전 관련 정보를 업데이트하세요:
- "현재 버전" 또는 "Version" 항목 찾아서 업데이트
- 새 기능이 추가된 경우 해당 섹션 추가/업데이트
- 변경된 API나 설정이 있으면 문서화

### 5단계: 버전 업데이트 실행
```bash
npm run version:bump <새버전>
```

### 6단계: Git 커밋 및 태그 푸시
```bash
git add .
git commit -m "chore: release v<새버전>"
git tag v<새버전>
git push origin main
git push --tags
```

### 7단계: 결과 보고
다음 정보를 사용자에게 보고하세요:
- 이전 버전 → 새 버전
- 버전 업데이트 이유 (MAJOR/MINOR/PATCH 선택 근거)
- CHANGELOG.md에 추가된 주요 변경사항
- GitHub Actions 빌드 링크: `https://github.com/zzamjak-cloud/IconMaker/actions`
- 예상 빌드 시간: 약 10-15분

## 에러 처리

### 커밋되지 않은 변경사항이 있는 경우
```
⚠️ 커밋되지 않은 변경사항이 있습니다.
먼저 변경사항을 커밋하거나 stash하시겠습니까?
```

### 원격 저장소와 동기화되지 않은 경우
```
⚠️ 원격 저장소와 동기화되지 않았습니다.
git pull을 실행하시겠습니까?
```

### 태그가 이미 존재하는 경우
```
❌ 태그 v<버전>이 이미 존재합니다.
다른 버전을 선택해주세요.
```

## 주의사항

1. **절대 강제 푸시하지 마세요** (`--force` 금지)
2. **main 브랜치에서만 릴리스하세요**
3. **버전은 항상 증가해야 합니다** (롤백 금지)
4. **CHANGELOG.md는 항상 최신 상태를 유지하세요**
5. **태그는 v접두사를 포함하세요** (예: v1.0.0)

## 사용 예시

### 예시 1: 자동 판단
```
사용자: 버전을 적절한 단계로 업데이트 해줘.

에이전트:
1. git log 분석...
2. 최근 커밋: "feat: 일괄 내보내기 기능 추가"
3. 판단: MINOR 버전 업데이트 (새 기능 추가)
4. 0.1.0 → 0.2.0 업데이트 진행
5. CHANGELOG.md 업데이트
6. 태그 푸시 완료
```

### 예시 2: 명시적 요청
```
사용자: 패치 버전으로 업데이트 해줘.

에이전트:
1. 0.2.0 → 0.2.1 업데이트 진행
2. CHANGELOG.md 업데이트 (버그 수정 사항)
3. 태그 푸시 완료
```

### 예시 3: 메이저 버전
```
사용자: 큰 업데이트니까 메이저 버전 올려줘.

에이전트:
1. 0.2.0 → 1.0.0 업데이트 진행
2. CHANGELOG.md에 Breaking Changes 섹션 추가
3. 태그 푸시 완료
```

---

**이제 작업을 시작하세요!**
